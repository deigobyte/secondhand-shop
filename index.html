<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>å¤§å–µçš„é—²ç½®</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #f5f5f5;
            padding-bottom: 60px;
        }
        
        /* éšè—çš„æ–‡ä»¶è¾“å…¥ */
        #cameraInput, #cameraInputEdit {
            display: none;
        }
        
        /* é¦–é¡µ */
        .header {
            background: #fff;
            padding: 12px 16px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 1px 3px rgba(0,0,0,0.05);
        }
        
        .header h1 {
            font-size: 18px;
            font-weight: 600;
        }
        
        .share-btn {
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
        }
        
        .grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 8px;
            padding: 8px;
        }
        
        .item-card {
            background: #fff;
            border-radius: 12px;
            overflow: hidden;
            position: relative;
        }
        
        .item-image {
            width: 100%;
            aspect-ratio: 1;
            object-fit: cover;
            display: block;
        }
        
        .item-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            color: #fff;
            font-size: 24px;
            font-weight: bold;
        }
        
        .item-info {
            padding: 10px;
        }
        
        .item-price {
            color: #ff5722;
            font-size: 18px;
            font-weight: bold;
        }
        
        .item-name {
            font-size: 14px;
            color: #333;
            margin-top: 4px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }
        
        .admin-entry {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: #fff;
            padding: 12px 16px;
            text-align: center;
            border-top: 1px solid #eee;
            font-size: 14px;
            color: #666;
        }
        
        /* è¯¦æƒ…é¡µ */
        .detail-page, .admin-page, .add-page, .edit-page {
            display: none;
            min-height: 100vh;
            background: #fff;
        }
        
        .detail-page.active, .admin-page.active, .add-page.active, .edit-page.active {
            display: block;
        }
        
        .detail-header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            padding: 12px 16px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: linear-gradient(to bottom, rgba(0,0,0,0.5), transparent);
            color: #fff;
            z-index: 100;
        }
        
        .back-btn {
            font-size: 20px;
            padding: 4px;
        }
        
        .detail-image {
            width: 100%;
            aspect-ratio: 1;
            object-fit: cover;
        }
        
        .detail-info {
            padding: 16px;
        }
        
        .detail-price {
            font-size: 28px;
            color: #ff5722;
            font-weight: bold;
        }
        
        .detail-name {
            font-size: 18px;
            font-weight: 600;
            margin-top: 8px;
            line-height: 1.4;
        }
        
        .detail-meta {
            display: flex;
            gap: 12px;
            margin-top: 12px;
            color: #999;
            font-size: 14px;
        }
        
        .detail-desc {
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid #f0f0f0;
            font-size: 15px;
            line-height: 1.8;
            color: #333;
        }
        
        .contact-section {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: #fff;
            padding: 12px 16px;
            border-top: 1px solid #eee;
            text-align: center;
        }
        
        .contact-btn {
            background: #07c160;
            color: #fff;
            border: none;
            padding: 14px 48px;
            border-radius: 24px;
            font-size: 16px;
            font-weight: 500;
        }
        
        .wechat-id {
            margin-top: 8px;
            font-size: 13px;
            color: #999;
        }
        
        /* ç®¡ç†é¡µ */
        .admin-header {
            background: #fff;
            padding: 12px 16px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid #f0f0f0;
        }
        
        .add-big-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #fff;
            margin: 16px;
            padding: 16px;
            border-radius: 12px;
            text-align: center;
            font-size: 16px;
            font-weight: 500;
        }
        
        .add-big-btn .icon {
            font-size: 32px;
            margin-bottom: 4px;
        }
        
        .stats {
            display: flex;
            justify-content: space-around;
            padding: 16px;
            background: #fff;
            margin-bottom: 8px;
        }
        
        .stat-item {
            text-align: center;
        }
        
        .stat-num {
            font-size: 24px;
            font-weight: bold;
            color: #333;
        }
        
        .stat-label {
            font-size: 13px;
            color: #999;
            margin-top: 2px;
        }
        
        .admin-list {
            background: #fff;
        }
        
        .admin-section-title {
            padding: 12px 16px;
            font-size: 14px;
            color: #666;
            background: #f5f5f5;
        }
        
        .admin-item {
            display: flex;
            padding: 12px 16px;
            border-bottom: 1px solid #f5f5f5;
            gap: 12px;
        }
        
        .admin-item-img {
            width: 80px;
            height: 80px;
            object-fit: cover;
            border-radius: 8px;
        }
        
        .admin-item-info {
            flex: 1;
        }
        
        .admin-item-name {
            font-size: 15px;
            font-weight: 500;
        }
        
        .admin-item-meta {
            font-size: 13px;
            color: #999;
            margin-top: 6px;
        }
        
        .admin-item-actions {
            display: flex;
            gap: 6px;
            margin-top: 8px;
            flex-wrap: wrap;
        }
        
        .action-btn {
            padding: 4px 10px;
            border-radius: 4px;
            font-size: 12px;
            border: 1px solid #ddd;
            background: #fff;
        }
        
        .action-btn.primary {
            background: #ff5722;
            color: #fff;
            border-color: #ff5722;
        }
        
        .action-btn.danger {
            background: #fff;
            color: #f44336;
            border-color: #f44336;
        }
        
        /* æ·»åŠ /ç¼–è¾‘å•†å“é¡µ */
        .add-header, .edit-header {
            background: #fff;
            padding: 12px 16px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid #f0f0f0;
        }
        
        .add-form, .edit-form {
            padding: 16px;
        }
        
        .photo-grid {
            display: flex;
            gap: 8px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        .photo-slot {
            width: 80px;
            height: 80px;
            border: 2px dashed #ddd;
            border-radius: 8px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            color: #999;
            cursor: pointer;
        }
        
        .photo-slot .text {
            font-size: 11px;
            margin-top: 4px;
        }
        
        .photo-preview {
            width: 80px;
            height: 80px;
            border-radius: 8px;
            overflow: hidden;
            position: relative;
        }
        
        .photo-preview img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .photo-preview .remove-btn {
            position: absolute;
            top: 2px;
            right: 2px;
            width: 20px;
            height: 20px;
            background: rgba(0,0,0,0.6);
            color: #fff;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            cursor: pointer;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-label {
            display: block;
            font-size: 14px;
            color: #333;
            margin-bottom: 8px;
        }
        
        .form-label .required {
            color: #ff5722;
        }
        
        .form-input {
            width: 100%;
            padding: 12px;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            font-size: 15px;
        }
        
        .form-input:focus {
            outline: none;
            border-color: #667eea;
        }
        
        .price-input-wrap {
            display: flex;
            align-items: center;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            padding: 0 12px;
        }
        
        .price-input-wrap .currency {
            color: #ff5722;
            font-weight: bold;
        }
        
        .price-input-wrap input {
            flex: 1;
            border: none;
            padding: 12px;
            font-size: 15px;
        }
        
        /* å¼¹çª— */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.5);
            z-index: 200;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }
        
        .modal.active {
            display: flex;
        }
        
        .modal-content {
            background: #fff;
            border-radius: 12px;
            padding: 24px;
            width: 100%;
            max-width: 320px;
            text-align: center;
        }
        
        .modal-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 16px;
        }
        
        .modal-input {
            width: 100%;
            padding: 12px;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            font-size: 16px;
            margin-bottom: 20px;
            text-align: center;
        }
        
        .modal-actions {
            display: flex;
            gap: 12px;
        }
        
        .modal-btn {
            flex: 1;
            padding: 12px;
            border-radius: 8px;
            border: none;
            font-size: 15px;
        }
        
        .modal-btn.cancel {
            background: #f5f5f5;
            color: #666;
        }
        
        .modal-btn.confirm {
            background: #ff5722;
            color: #fff;
        }
        
        .modal-btn.danger {
            background: #f44336;
            color: #fff;
        }
    </style>
</head>
<body>
    <!-- éšè—çš„æ–‡ä»¶è¾“å…¥ï¼Œç”¨äºè°ƒç”¨ç›¸æœº -->
    <input type="file" id="cameraInput" accept="image/*" capture="camera">
    <input type="file" id="cameraInputEdit" accept="image/*" capture="camera">
    
    <!-- é¦–é¡µ -->
    <div id="homePage" class="home-page">
        <div class="header">
            <h1>å¤§å–µçš„é—²ç½®</h1>
            <div class="share-btn">â†—ï¸</div>
        </div>
        
        <div class="grid" id="itemGrid">
            <!-- å•†å“å¡ç‰‡ç”± JS ç”Ÿæˆ -->
        </div>
        
        <div class="admin-entry" onclick="showAdmin()">
            ğŸ” ç®¡ç†åå°
        </div>
    </div>
    
    <!-- è¯¦æƒ…é¡µ -->
    <div id="detailPage" class="detail-page">
        <div class="detail-header">
            <span class="back-btn" onclick="backToHome()">â†</span>
            <span>å•†å“è¯¦æƒ…</span>
            <span style="width: 28px;"></span>
        </div>
        
        <img id="detailImage" class="detail-image" src="" alt="">
        
        <div class="detail-info">
            <div class="detail-price" id="detailPrice"></div>
            <div class="detail-name" id="detailName"></div>
            <div class="detail-meta">
                <span id="detailCondition"></span>
                <span id="detailCategory"></span>
            </div>
            <div class="detail-desc" id="detailDesc"></div>
        </div>
        
        <div style="height: 100px;"></div>
        
        <div class="contact-section">
            <button class="contact-btn" onclick="copyWechat()">ğŸ“± åŠ å¾®ä¿¡è´­ä¹°</button>
            <div class="wechat-id">å¾®ä¿¡å·ï¼šdamao2024ï¼ˆç‚¹å‡»å¤åˆ¶ï¼‰</div>
        </div>
    </div>
    
    <!-- ç®¡ç†é¡µ -->
    <div id="adminPage" class="admin-page">
        <div class="admin-header">
            <span>ç®¡ç†åå°</span>
            <span onclick="backToHome()" style="color: #666;">é€€å‡º</span>
        </div>
        
        <div class="add-big-btn" onclick="showAddPage()">
            <div class="icon">ğŸ“·</div>
            <div>æ‹ä¸ªç…§ä¸Šæ¶å•†å“</div>
        </div>
        
        <div class="stats">
            <div class="stat-item">
                <div class="stat-num" id="activeCount">0</div>
                <div class="stat-label">åœ¨å”®</div>
            </div>
            <div class="stat-item">
                <div class="stat-num" id="soldCount">0</div>
                <div class="stat-label">å·²å”®</div>
            </div>
        </div>
        
        <div class="admin-list" id="adminList">
            <!-- ç®¡ç†åˆ—è¡¨ç”± JS ç”Ÿæˆ -->
        </div>
    </div>
    
    <!-- æ·»åŠ å•†å“é¡µ -->
    <div id="addPage" class="add-page">
        <div class="add-header">
            <span onclick="backToAdmin()">å–æ¶ˆ</span>
            <span style="font-weight: 600;">å‘å¸ƒå•†å“</span>
            <span style="color: #07c160; font-weight: 500;" onclick="submitItem()">å‘å¸ƒ</span>
        </div>
        
        <div class="add-form">
            <div class="photo-grid" id="addPhotoGrid">
                <div class="photo-slot" onclick="triggerCamera()">
                    ğŸ“·
                    <span class="text">æ‹ç…§</span>
                </div>
            </div>
            
            <div class="form-group">
                <label class="form-label">ä»·æ ¼ <span class="required">*</span></label>
                <div class="price-input-wrap">
                    <span class="currency">Â¥</span>
                    <input type="number" id="inputPrice" placeholder="è¾“å…¥ä»·æ ¼">
                </div>
            </div>
            
            <div class="form-group">
                <label class="form-label">åç§° <span class="required">*</span></label>
                <input type="text" class="form-input" id="inputName" placeholder="è¾“å…¥å•†å“åç§°ï¼Œå¦‚ï¼šiPhone 12 æ‰‹æœºå£³">
            </div>
            
            <div class="form-group">
                <label class="form-label">æˆè‰²</label>
                <select class="form-input" id="inputCondition">
                    <option>å…¨æ–°æœªæ‹†å°</option>
                    <option>99æ–°</option>
                    <option selected>95æ–°</option>
                    <option>9æˆæ–°</option>
                    <option>8æˆæ–°</option>
                    <option>ä½¿ç”¨è¿‡</option>
                </select>
            </div>
            
            <div class="form-group">
                <label class="form-label">åˆ†ç±»</label>
                <select class="form-input" id="inputCategory">
                    <option value="electronics">ğŸ“± ç”µå­äº§å“</option>
                    <option value="furniture">ğŸª‘ å®¶å…·</option>
                    <option value="books">ğŸ“š ä¹¦ç±</option>
                    <option value="clothing">ğŸ‘• æœé¥°</option>
                    <option value="others">ğŸ“¦ å…¶ä»–</option>
                </select>
            </div>
            
            <div class="form-group">
                <label class="form-label">æè¿°ï¼ˆå¯é€‰ï¼‰</label>
                <textarea class="form-input" id="inputDesc" rows="3" placeholder="ç®€å•æè¿°ä¸€ä¸‹å•†å“..."></textarea>
            </div>
        </div>
        
        <div style="height: 80px;"></div>
    </div>
    
    <!-- ç¼–è¾‘å•†å“é¡µ -->
    <div id="editPage" class="edit-page">
        <div class="edit-header">
            <span onclick="backToAdmin()">å–æ¶ˆ</span>
            <span style="font-weight: 600;">ç¼–è¾‘å•†å“</span>
            <span style="color: #07c160; font-weight: 500;" onclick="saveEditItem()">ä¿å­˜</span>
        </div>
        
        <div class="edit-form">
            <div class="photo-grid" id="editPhotoGrid">
                <div class="photo-slot" onclick="triggerCameraEdit()">
                    ğŸ“·
                    <span class="text">æ‹ç…§</span>
                </div>
            </div>
            
            <div class="form-group">
                <label class="form-label">ä»·æ ¼ <span class="required">*</span></label>
                <div class="price-input-wrap">
                    <span class="currency">Â¥</span>
                    <input type="number" id="editPrice" placeholder="è¾“å…¥ä»·æ ¼">
                </div>
            </div>
            
            <div class="form-group">
                <label class="form-label">åç§° <span class="required">*</span></label>
                <input type="text" class="form-input" id="editName" placeholder="è¾“å…¥å•†å“åç§°">
            </div>
            
            <div class="form-group">
                <label class="form-label">æˆè‰²</label>
                <select class="form-input" id="editCondition">
                    <option>å…¨æ–°æœªæ‹†å°</option>
                    <option>99æ–°</option>
                    <option>95æ–°</option>
                    <option>9æˆæ–°</option>
                    <option>8æˆæ–°</option>
                    <option>ä½¿ç”¨è¿‡</option>
                </select>
            </div>
            
            <div class="form-group">
                <label class="form-label">åˆ†ç±»</label>
                <select class="form-input" id="editCategory">
                    <option value="electronics">ğŸ“± ç”µå­äº§å“</option>
                    <option value="furniture">ğŸª‘ å®¶å…·</option>
                    <option value="books">ğŸ“š ä¹¦ç±</option>
                    <option value="clothing">ğŸ‘• æœé¥°</option>
                    <option value="others">ğŸ“¦ å…¶ä»–</option>
                </select>
            </div>
            
            <div class="form-group">
                <label class="form-label">æè¿°ï¼ˆå¯é€‰ï¼‰</label>
                <textarea class="form-input" id="editDesc" rows="3" placeholder="ç®€å•æè¿°ä¸€ä¸‹å•†å“..."></textarea>
            </div>
        </div>
        
        <div style="height: 80px;"></div>
    </div>
    
    <!-- æ”¹ä»·å¼¹çª— -->
    <div id="priceModal" class="modal">
        <div class="modal-content">
            <div class="modal-title">ä¿®æ”¹ä»·æ ¼</div>
            <input type="number" class="modal-input" id="modalPrice" placeholder="è¾“å…¥æ–°ä»·æ ¼">
            <div class="modal-actions">
                <button class="modal-btn cancel" onclick="closeModal()">å–æ¶ˆ</button>
                <button class="modal-btn confirm" onclick="confirmPrice()">ç¡®è®¤</button>
            </div>
        </div>
    </div>
    
    <!-- åˆ é™¤ç¡®è®¤å¼¹çª— -->
    <div id="deleteModal" class="modal">
        <div class="modal-content">
            <div class="modal-title">ç¡®è®¤åˆ é™¤ï¼Ÿ</div>
            <p style="color: #666; margin-bottom: 20px;">åˆ é™¤åæ— æ³•æ¢å¤</p>
            <div class="modal-actions">
                <button class="modal-btn cancel" onclick="closeDeleteModal()">å–æ¶ˆ</button>
                <button class="modal-btn danger" onclick="confirmDelete()">åˆ é™¤</button>
            </div>
        </div>
    </div>
    
    <!-- å¯†ç éªŒè¯å¼¹çª— -->
    <div id="passwordModal" class="modal active">
        <div class="modal-content">
            <div class="modal-title">ğŸ” è¯·è¾“å…¥ç®¡ç†å¯†ç </div>
            <input type="password" class="modal-input" id="adminPassword" placeholder="å¯†ç ">
            <div class="modal-actions">
                <button class="modal-btn cancel" onclick="closePasswordModal()">å–æ¶ˆ</button>
                <button class="modal-btn confirm" onclick="checkPassword()">è¿›å…¥</button>
            </div>
        </div>
    </div>

    <script>
        // Mock æ•°æ®
        let items = [
            {
                id: 1,
                name: 'iPhone 12 Pro æ‰‹æœºå£³å¥—è£…',
                price: 299,
                condition: '95æ–°',
                category: 'ç”µå­äº§å“',
                categoryValue: 'electronics',
                desc: 'ä¹°äº†æ²¡å¤šä¹…ï¼Œæ¢æ‰‹æœºäº†æ‰€ä»¥å‡ºæ‰ã€‚åŒ…å«3ä¸ªå£³å­+è´´è†œï¼ŒåŸä»·599ä¹°çš„ã€‚',
                image: 'https://images.unsplash.com/photo-1603313011101-320f26a4f6f6?w=400&h=400&fit=crop',
                status: 'active'
            },
            {
                id: 2,
                name: 'å®œå®¶ä¹¦æ¡Œ ç™½è‰²',
                price: 150,
                condition: '8æˆæ–°',
                category: 'å®¶å…·',
                categoryValue: 'furniture',
                desc: 'å°ºå¯¸ 120x60cmï¼Œç”¨äº†ä¸¤å¹´ï¼Œæ¬å®¶å¸¦ä¸èµ°ã€‚',
                image: 'https://images.unsplash.com/photo-1518455027359-f3f8164ba6bd?w=400&h=400&fit=crop',
                status: 'active'
            },
            {
                id: 3,
                name: 'JavaScripté«˜çº§ç¨‹åºè®¾è®¡',
                price: 50,
                condition: '9æˆæ–°',
                category: 'ä¹¦ç±',
                categoryValue: 'books',
                desc: 'å°±ç¿»è¿‡å‡ æ¬¡ï¼Œå‡ ä¹å…¨æ–°ã€‚',
                image: 'https://images.unsplash.com/photo-1544947950-fa07a98d237f?w=400&h=400&fit=crop',
                status: 'sold'
            },
            {
                id: 4,
                name: 'Nike è¿åŠ¨é‹ 42ç ',
                price: 199,
                condition: '95æ–°',
                category: 'æœé¥°',
                categoryValue: 'clothing',
                desc: 'ä¹°å°äº†ï¼Œåªç©¿è¿‡ä¸¤æ¬¡ã€‚',
                image: 'https://images.unsplash.com/photo-1542291026-7eec264c27ff?w=400&h=400&fit=crop',
                status: 'active'
            },
            {
                id: 5,
                name: 'è“ç‰™éŸ³ç®± ä¾¿æºå¼',
                price: 88,
                condition: 'ä½¿ç”¨è¿‡',
                category: 'ç”µå­äº§å“',
                categoryValue: 'electronics',
                desc: 'éŸ³è´¨ä¸é”™ï¼Œç»­èˆª8å°æ—¶ã€‚',
                image: 'https://images.unsplash.com/photo-1608043152269-423dbba4e7e1?w=400&h=400&fit=crop',
                status: 'active'
            },
            {
                id: 6,
                name: 'æœºæ¢°é”®ç›˜ é’è½´',
                price: 350,
                condition: '99æ–°',
                category: 'ç”µå­äº§å“',
                categoryValue: 'electronics',
                desc: 'IKBC é”®ç›˜ï¼ŒRGBèƒŒå…‰ï¼Œæ‰‹æ„Ÿå¾ˆå¥½ã€‚',
                image: 'https://images.unsplash.com/photo-1595225476474-87563907a212?w=400&h=400&fit=crop',
                status: 'active'
            }
        ];
        
        let editingId = null;
        let deletingId = null;
        let tempPhotos = [];
        let tempPhotosEdit = [];
        
        // åˆå§‹åŒ–ç›¸æœºè¾“å…¥ç›‘å¬
        document.getElementById('cameraInput').addEventListener('change', function(e) {
            if (e.target.files && e.target.files[0]) {
                const reader = new FileReader();
                reader.onload = function(event) {
                    tempPhotos.push(event.target.result);
                    renderPhotoGrid('addPhotoGrid', tempPhotos, false);
                };
                reader.readAsDataURL(e.target.files[0]);
            }
        });
        
        document.getElementById('cameraInputEdit').addEventListener('change', function(e) {
            if (e.target.files && e.target.files[0]) {
                const reader = new FileReader();
                reader.onload = function(event) {
                    tempPhotosEdit.push(event.target.result);
                    renderPhotoGrid('editPhotoGrid', tempPhotosEdit, true);
                };
                reader.readAsDataURL(e.target.files[0]);
            }
        });
        
        // è§¦å‘ç›¸æœº
        function triggerCamera() {
            document.getElementById('cameraInput').click();
        }
        
        function triggerCameraEdit() {
            document.getElementById('cameraInputEdit').click();
        }
        
        // æ¸²æŸ“ç…§ç‰‡ç½‘æ ¼
        function renderPhotoGrid(gridId, photos, isEdit) {
            const grid = document.getElementById(gridId);
            let html = '';
            
            photos.forEach((photo, index) => {
                html += `
                    <div class="photo-preview">
                        <img src="${photo}" alt="">
                        <div class="remove-btn" onclick="removePhoto(${index}, ${isEdit})">Ã—</div>
                    </div>
                `;
            });
            
            html += `
                <div class="photo-slot" onclick="${isEdit ? 'triggerCameraEdit()' : 'triggerCamera()'}">
                    ğŸ“·
                    <span class="text">æ‹ç…§</span>
                </div>
            `;
            
            grid.innerHTML = html;
        }
        
        // åˆ é™¤ç…§ç‰‡
        function removePhoto(index, isEdit) {
            if (isEdit) {
                tempPhotosEdit.splice(index, 1);
                renderPhotoGrid('editPhotoGrid', tempPhotosEdit, true);
            } else {
                tempPhotos.splice(index, 1);
                renderPhotoGrid('addPhotoGrid', tempPhotos, false);
            }
        }
        
        // æ¸²æŸ“é¦–é¡µ
        function renderHome() {
            const grid = document.getElementById('itemGrid');
            grid.innerHTML = items.map(item => `
                <div class="item-card" onclick="showDetail(${item.id})">
                    <img class="item-image" src="${item.image}" alt="">
                    ${item.status === 'sold' ? '<div class="item-overlay">å·²å”®</div>' : ''}
                    <div class="item-info">
                        <div class="item-price">Â¥${item.price}</div>
                        <div class="item-name">${item.name}</div>
                    </div>
                </div>
            `).join('');
        }
        
        // æ˜¾ç¤ºè¯¦æƒ…
        function showDetail(id) {
            const item = items.find(i => i.id === id);
            if (!item) return;
            
            document.getElementById('detailImage').src = item.image;
            document.getElementById('detailPrice').textContent = `Â¥${item.price}${item.status === 'sold' ? ' (å·²å”®)' : ''}`;
            document.getElementById('detailName').textContent = item.name;
            document.getElementById('detailCondition').textContent = item.condition;
            document.getElementById('detailCategory').textContent = item.category;
            document.getElementById('detailDesc').textContent = item.desc;
            
            document.getElementById('homePage').style.display = 'none';
            document.getElementById('detailPage').classList.add('active');
        }
        
        // è¿”å›é¦–é¡µ
        function backToHome() {
            document.getElementById('homePage').style.display = 'block';
            document.getElementById('detailPage').classList.remove('active');
            document.getElementById('adminPage').classList.remove('active');
            document.getElementById('addPage').classList.remove('active');
            document.getElementById('editPage').classList.remove('active');
        }
        
        // è¿”å›ç®¡ç†é¡µ
        function backToAdmin() {
            document.getElementById('addPage').classList.remove('active');
            document.getElementById('editPage').classList.remove('active');
            document.getElementById('adminPage').classList.add('active');
            renderAdmin();
        }
        
        // å¤åˆ¶å¾®ä¿¡
        function copyWechat() {
            alert('å¾®ä¿¡å·å·²å¤åˆ¶ï¼šdamao2024');
        }
        
        // æ˜¾ç¤ºç®¡ç†é¡µ
        function showAdmin() {
            document.getElementById('passwordModal').classList.add('active');
        }
        
        // å…³é—­å¯†ç å¼¹çª—
        function closePasswordModal() {
            document.getElementById('passwordModal').classList.remove('active');
        }
        
        // éªŒè¯å¯†ç 
        function checkPassword() {
            const pwd = document.getElementById('adminPassword').value;
            if (pwd === '123456') {
                document.getElementById('passwordModal').classList.remove('active');
                document.getElementById('homePage').style.display = 'none';
                document.getElementById('adminPage').classList.add('active');
                document.getElementById('adminPassword').value = '';
                renderAdmin();
            } else {
                alert('å¯†ç é”™è¯¯');
            }
        }
        
        // æ¸²æŸ“ç®¡ç†åˆ—è¡¨
        function renderAdmin() {
            const activeItems = items.filter(i => i.status === 'active');
            const soldItems = items.filter(i => i.status === 'sold');
            
            document.getElementById('activeCount').textContent = activeItems.length;
            document.getElementById('soldCount').textContent = soldItems.length;
            
            const list = document.getElementById('adminList');
            list.innerHTML = `
                <div class="admin-section-title">åœ¨å”®å•†å“ (${activeItems.length})</div>
                ${activeItems.map(item => renderAdminItem(item)).join('')}
                ${soldItems.length > 0 ? `
                    <div class="admin-section-title">å·²å”®å‡º (${soldItems.length})</div>
                    ${soldItems.map(item => renderAdminItem(item)).join('')}
                ` : ''}
            `;
        }
        
        function renderAdminItem(item) {
            return `
                <div class="admin-item">
                    <img class="admin-item-img" src="${item.image}" alt="">
                    <div class="admin-item-info">
                        <div class="admin-item-name">${item.name}</div>
                        <div class="admin-item-meta">Â¥${item.price} Â· ${item.condition} Â· ${item.category}</div>
                        <div class="admin-item-actions">
                            <button class="action-btn" onclick="editItem(${item.id})">ç¼–è¾‘</button>
                            <button class="action-btn primary" onclick="quickEditPrice(${item.id})">æ”¹ä»·</button>
                            ${item.status === 'active' 
                                ? `<button class="action-btn" onclick="markSold(${item.id})">æ ‡è®°å·²å”®</button>`
                                : `<button class="action-btn" onclick="markActive(${item.id})">é‡æ–°ä¸Šæ¶</button>`
                            }
                            <button class="action-btn danger" onclick="deleteItem(${item.id})">åˆ é™¤</button>
                        </div>
                    </div>
                </div>
            `;
        }
        
        // ç¼–è¾‘å•†å“
        function editItem(id) {
            const item = items.find(i => i.id === id);
            if (!item) return;
            
            editingId = id;
            tempPhotosEdit = [item.image];
            
            // å¡«å……è¡¨å•
            document.getElementById('editPrice').value = item.price;
            document.getElementById('editName').value = item.name;
            document.getElementById('editCondition').value = item.condition;
            document.getElementById('editCategory').value = item.categoryValue || 'electronics';
            document.getElementById('editDesc').value = item.desc || '';
            
            // æ¸²æŸ“ç…§ç‰‡
            renderPhotoGrid('editPhotoGrid', tempPhotosEdit, true);
            
            // æ˜¾ç¤ºç¼–è¾‘é¡µ
            document.getElementById('adminPage').classList.remove('active');
            document.getElementById('editPage').classList.add('active');
        }
        
        // ä¿å­˜ç¼–è¾‘
        function saveEditItem() {
            const price = document.getElementById('editPrice').value;
            const name = document.getElementById('editName').value;
            const condition = document.getElementById('editCondition').value;
            const category = document.getElementById('editCategory');
            const categoryValue = category.value;
            const categoryText = category.options[category.selectedIndex].text;
            const desc = document.getElementById('editDesc').value;
            
            if (!price || !name) {
                alert('è¯·å¡«å†™ä»·æ ¼å’Œåç§°');
                return;
            }
            
            const item = items.find(i => i.id === editingId);
            if (item) {
                item.price = parseInt(price);
                item.name = name;
                item.condition = condition;
                item.category = categoryText;
                item.categoryValue = categoryValue;
                item.desc = desc || 'æš‚æ— æè¿°';
                item.image = tempPhotosEdit[0] || item.image;
                
                alert('å•†å“å·²æ›´æ–°ï¼');
                backToAdmin();
                renderHome();
            }
        }
        
        // å¿«é€Ÿæ”¹ä»·
        function quickEditPrice(id) {
            editingId = id;
            const item = items.find(i => i.id === id);
            document.getElementById('modalPrice').value = item.price;
            document.getElementById('priceModal').classList.add('active');
        }
        
        function closeModal() {
            document.getElementById('priceModal').classList.remove('active');
        }
        
        function confirmPrice() {
            const newPrice = document.getElementById('modalPrice').value;
            if (newPrice && editingId) {
                const item = items.find(i => i.id === editingId);
                item.price = parseInt(newPrice);
                renderAdmin();
                renderHome();
                closeModal();
                alert('ä»·æ ¼å·²ä¿®æ”¹');
            }
        }
        
        // æ ‡è®°å·²å”®
        function markSold(id) {
            if (confirm('ç¡®å®šæ ‡è®°ä¸ºå·²å”®å‡ºï¼Ÿ')) {
                const item = items.find(i => i.id === id);
                item.status = 'sold';
                renderAdmin();
                renderHome();
            }
        }
        
        // é‡æ–°ä¸Šæ¶
        function markActive(id) {
            const item = items.find(i => i.id === id);
            item.status = 'active';
            renderAdmin();
            renderHome();
        }
        
        // åˆ é™¤å•†å“
        function deleteItem(id) {
            deletingId = id;
            document.getElementById('deleteModal').classList.add('active');
        }
        
        function closeDeleteModal() {
            document.getElementById('deleteModal').classList.remove('active');
        }
        
        function confirmDelete() {
            if (deletingId) {
                items = items.filter(i => i.id !== deletingId);
                renderAdmin();
                renderHome();
                closeDeleteModal();
                alert('å•†å“å·²åˆ é™¤');
            }
        }
        
        // æ˜¾ç¤ºæ·»åŠ é¡µ
        function showAddPage() {
            tempPhotos = [];
            renderPhotoGrid('addPhotoGrid', tempPhotos, false);
            
            // æ¸…ç©ºè¡¨å•
            document.getElementById('inputPrice').value = '';
            document.getElementById('inputName').value = '';
            document.getElementById('inputCondition').selectedIndex = 2;
            document.getElementById('inputCategory').selectedIndex = 0;
            document.getElementById('inputDesc').value = '';
            
            document.getElementById('adminPage').classList.remove('active');
            document.getElementById('addPage').classList.add('active');
        }
        
        // æäº¤å•†å“
        function submitItem() {
            const price = document.getElementById('inputPrice').value;
            const name = document.getElementById('inputName').value;
            const condition = document.getElementById('inputCondition').value;
            const category = document.getElementById('inputCategory');
            const categoryValue = category.value;
            const categoryText = category.options[category.selectedIndex].text;
            const desc = document.getElementById('inputDesc').value;
            
            if (!price || !name) {
                alert('è¯·å¡«å†™ä»·æ ¼å’Œåç§°');
                return;
            }
            
            const newItem = {
                id: Date.now(),
                name: name,
                price: parseInt(price),
                condition: condition,
                category: categoryText,
                categoryValue: categoryValue,
                desc: desc || 'æš‚æ— æè¿°',
                image: tempPhotos[0] || 'https://images.unsplash.com/photo-1558618666-fcd25c85cd64?w=400&h=400&fit=crop',
                status: 'active'
            };
            
            items.unshift(newItem);
            
            alert('å•†å“å‘å¸ƒæˆåŠŸï¼');
            backToAdmin();
            renderHome();
        }
        
        // åˆå§‹åŒ–
        renderHome();
    </script>
</body>
</html>
